---
title:  第八章：人力资源管理
date: 2021-06-13 16:30:09
tags:
---

本章关注人力资源数据，这一章也是本书跨行业的业务应用系列的最后一章。与《第七章：会计》中讲述的会计和财务数据类似，HR信息也在组织内部广泛传播。一个组织想更好地理解员工的人口统计学特征、技能、收入情况和绩效，这样才能把员工的影响力发挥到最大。本章，我们将在HR数据环境下，探索几种维度建模技术。

第9章讨论以下概念：

+ 跟踪员工概要信息变化的维度表
+ 总人数的周期快照表
+ 以HR为中心的流程片断的总线矩阵
+ 套装类的数据仓库/商业智能或数据模型的优缺点
+ 员工的递归层级
+ 通过维度属性、支架和桥接，处理技能的多值关键词属性问题
+ 调查问卷数据
+ 文本评论

## 员工概要信息跟踪

迄今为止，我们设计的维度模型是非常相似的。事实表包含关键绩效度量。一般来说，可以在所有维度之上添加度量。对于维度建模者来说，会非常容易陷入**可加性**的满足感（。在大多数情况下，这恰恰是我们希望的运行方式。然而，借助人力资源的员工数据，一个强健的员工维度会支持业务用户按他们自己的需求进行各种各样的度量。

设计一个业务场景，假设你在一家大型组织的HR部门工作。每个员工有明细的HR概要信息，这些概要信息至少包含100个属性，包括雇用日期、岗位职级、薪酬、核定日期、核定收入、假期津贴、所属组织、教育背景、地址、保险计划，以及其他更多属性。员工会持续地经过雇用、调转和晋升等状态，需要通过各种方式调整他们的概要信息。

精准跟踪和分析员工的概要变化，是优先级较高的业务需求。你要能够立即看到这样一个模型：每个员工的概要变化事件，要在事务粒度的事实表上可以捕获到，如图9-1所示。这个有点通用化的事实表的粒度，是一行表示一个员工的概要事件。因为与员工概要相关的变化（像一个新地址，或职级晋升），没有数值型度量，这个事实表是无事实的。

{% asset_image 9-1.png 9-1 %}

在这个模型草稿中，维度包含了事务日期、事务类型和员工。事务类型维度指的是导致某个特定行产生的原因编码，比如晋升或地址变更。员工维度具有很多属性列，所以是一个极其宽的维度。

我们想像一下使用类型2的缓慢变化维技术，在员工维度表上追踪概要变化属性的情况。结果就是，在图9-1所示的事实表上每一个员工概要事务的变化，都要在员工维度表上创建一个新的类型2的行，以记录每一个员工概要变化事件。这个新行保持着对员工概要的精确表述，直到未来某个不确定的时间点，下一个员工事件发生时止。机警的读者很快就会指出，员工概要事务事实表和类型2员工维度表具有相同的行数，且它们几乎总是连在一起的。在这一点上，维度建模警报就生效了。你当然不希望事实表具有和维度表一样多的行。

不再使用上述初始模型，你可以通过简化设计对维度表进行修补，让它变得更加强大，顺便移除概要事务事件事实表。如图9-2所描述的那样，员工维度表包含一个员工概要变化的特征快照。事务类型描述成为员工维度上的变化原因属性，用以跟踪导致员工概要变化的原因。在某些情况下，受影响的特征是数值型的。如果数值型特征要用来汇总而不是用来进行约束，那么它们就应该放在事实表上而不是维度表上。

{% asset_image 9-2.png chapter08 %}

正如你所希望的那样，员工的代理键值作为维度主键；在HR经营型系统中使用的、能够持久地识别每一个员工的自然型的员工ID字段，被当作一个维度属性来处理。

### 具有起始日期和过期日期的精确时间跨度

在《第五章：采购》中讨论过缓慢变化维的相关技术，员工维度表需要包含两列，以捕获一个具体行的生效日期和之后的过期日期。这两列精确地定义了时间跨度，在这个时间跨度里，员工概要信息也是准确的。从历史上看，当每天的数据延迟是规范的，起始日期和结束日期列上就是日期。然而，如果你从业务流程中加载数据比较频繁，上述列就应当是日期/时间戳类型，这样才能关联到到适当的员工概要行，概要行可以是同一天之中从早上9点到晚上9之间的不同时刻的经营事件。

当前行的过期属性设置成未来的某天。当ETL系统发现一个新的属性概要进而当前行需要过期的时候，过期属性一般来说要设置成在新行生效时间戳“恰好之前”的那个时刻，既可以是前一天、前一分钟或前一秒。

如果员工的概要在一段时间内发生了准确地变化，那么员工返回到了之前的特征集中，一个新的员工维度行就要被插入进来。千万不可简单地重新引用之前的概要信息，并修改过期日期，这样做会导致在同一时间内有多个维度行生效。

当前行标识符可快速返回任何一个员工最近的状态。如果针对这个员工出现了一个新的概要行，那么之前概要行上的标识符需要更新，以表示它不再是当前概要。

就其本身而言，标记了类型2的员工维度的日期/时间戳可以回答很多有价值的HR查询。你可以选择任意一个历史时点，通过限制日期/时间戳大于等于起始日期/时间戳并小于过期日期/时间戳，查询在某个具体时刻，组织里有多少名员工以及他们的明细概要是什么样的。这个查询可以执行计数和对所有从这个约束中返回的行进行约束（？）。

### 维度变化原因跟踪

当一个维度行包含了类型2属性的时候，你可以用变化的原因来补充这个维度。通过这种方式，有些以ETL为中心的元数据就被嵌入到真实数据中（？）。每个维度行上的变化原因属性可以是变化原因的两个字符的缩写。比如，对于姓氏的变化原因属性就可以简写成LN，或其他更易理解的值，像Last Name。当然，这要依赖于使用倾向以及受众。如果有人查询去年有多少人变更过邮编，SELECT语句中包含LIKE操作符和通配符即可，像“WHERE ChangeReason LIKE '%ZIP%’”这样。

因为维度上的多个属性可能同时变化，这些变化在这个维度上只用一行表示，变化原因也就可能是包含多个变化原因的多值形式。本章后面我们将讨论员工技能，可以把多个原因编码处理成单个文本字符串属性，比如“|Last Name|ZIP|”或通过一个多值桥接表来实现。

> **提示：** 每一个类型2的缓慢变化维属性上的起始日期和过期日期/时间戳，再加上原因编码描述，就可以针对维度自身，实现精确的维度切片。

最后，员工概要变化可以在底层的源系统上通过与每一个单一的员工属性变化相关的微型事务集合来捕获。在数据仓库系统中，你可能想把这些来源于源系统的微型事实压缩起来，并把它视为一个超级事务（像员工晋升事务），因为把这些微型事务都当作一个个独立的类型2属性变化来处理，这是愚蠢的行为。新的类型2维度行将会在一个步骤中反映出与此相关的所有属性变化。识别这些超级事务是聪明的行为。很显然，识别它们的最好方法，是HR应用软件要确保能够捕获最高级别的变化行为。

### 作为类型2属性或事实表的概要变化

我们刚刚讨论过，在员工维度中，对员工属性变化采用类型2技术，根据生效日期和结束日期的概要进行跟踪。设计人员经常会全身心地拥抱这种模式，并试图使用它来捕获每一个以员工为中心的属性变化。对于一个拥有10万人的组织来说，这种设计可能会导致维度表潜在地拥有数以百计的属性和数以百万计的行，因为属性太容易变化。

在员工维度表中追踪变化，可以让你非常容易地把员工概要信息关联到业务流程上。事实上，当事件发生时，只要简单地加载这些带有员工键值的事实表，在员工属性的全谱系的基础上，对事实表进行过滤和分组。

但钟摆的摆幅实在太大。你不大可能使用员工维度来追踪每一个员工的评审事件、每一个福利分享事件，或者每一个专业的开发事件。在下一节中的图9-4所示的总线矩阵中，很多事件包含其他维度，像事件日期、组织、福利描述、复核人、审核人、离职面谈者、离职原因，以及其他一系列维度。然后，它们中的大部分应当被当作独立的以流程为中心的事实表来处理。尽管大部分人力资源事件都是无事实的，用事实表捕获它们，可以让业务用户更容易地通过时间序列和其他相关维度，对变化进行计数并发现趋势。

当然，这些HR事件导致的结果（比如晋升导致职级调整），一般来说也要作为员工维度的一个属性包含进来。但是，设计人员有时会犯错误：他们在员工维度上增加很多外键的支架（像审核人、收益、离职原因和其他与员工维度关联的维度），这会导致维度负载增加，不便于应用导航。

## 人数周期快照表

在HR系统中除了对员工信息进行概要处理以外，你可能还想定期知道员工状态信息。业务经理对计数、统计和汇总值非常感兴趣，包括员工人数、已付薪酬、假期中的已休假天数、新增加的假期天数、新雇佣的人数，以及晋升人数，等等。他们想通过各种可能的切片（包括时间和组织维度，连同员工特征），对上述数据进行分析。

如图9－3所示，员工人数周期快照由一个看起来很普通的事实表组成，这个事实表有三个维度：月，员工和组织。月维度表包括常用的以月为粒度的公司日期描述符。员工维度键事实上与给定报告月份最后一天的员工维度行相关联，这样才能保证月末报告是员工概要信息的正确描述。组织维度则包括员工在相关月份结束时所归属的组织信息。

{% asset_image 9-3.png chapter08 %}

人数周期快照上的事实由月度数值型度量和计数组成，只通过员工维度表很难计算出这些度量和计数。除了任何余额型的事实之外，这些月度的计数和度量在所有维度或维度属性上都是具有可加性。这些余额，与其他余额一样，是半可加性的，必须在通过其他维度相加之后，通过月度维度进行平均。

## HR流程的总线矩阵

尽管具备精确的类型2缓慢变化维跟踪的员工维度与HR核心绩效度量的月度周期快照之间关联起来是一个好的开端，但这对于跟踪HR数据来源来说，只能算表面文章。图9－4展示了HR专家和业务经理们很可能非常渴望分析的其他业务流程。我们已经对这个初步设计的总线矩阵，再补充每个流程可能用到的事实表类型。然而，源数据的现状和业务需求可能需要不同的或互补的处理。

{% asset_image 9-4.png chapter08 %}

有些业务流程可以捕获绩效度量，但很多流程则导致无事实的事实表现出，像福利资格或福利分享。

## 套装分析方案和数据模型

很多组织购买软件供应商的解决方案以满足他们的HR的应用需求，大部分产品都有数据仓库/BI插件。除此之外，其他供应商则售卖标准的数据模型，内置了预先建好的、针对主流HR应用产品的数据装载工具。

供应商和支持者们辩解道：这些标准的、预先内置的方案和模型，能降低数据模型的范围和ETL的开发工作量，允许用户以更快的速度和更低的风险推进实施成功。毕竟，每个组织的HR部门都会经过雇用员工、登记注册、发薪补偿、绩效考核以及最后处理离职等工作流程。当你能够购买标准化的数据模型或者完整的解决方案时，为什么要重新造轮子来支持这些通用的业务流程呢？

尽管套装软件具有不容置疑的功能通用性（特别是在HR领域内），企业一般都有一些独特的需求。为了处理这些需求上的细微差别，大部分软件供应商都在产品中引入了抽取功能，以此让它们的产品更容易“个性定制”。

这些抽取功能（就像宴会厅的桌子和相关配套设备那样，它们只能描述通用的属性列名或角色，而不能提供更有意义的标识），提供了适应多个企业场景的灵活性。尽管实施适应性（供应商希望它们的产品能覆盖客户所有的潜在业务场景）上占优，但缺点是与之相关的复杂性提高了。

与供应商产品朝夕相处的HR专家们想调整自己的词汇表述方式，以适应软件提供的抽取功能。但这些抽取功能对于那些对产品涉足不深的业务经理们来说，简单像一门新的外语那样难以理解。通过套装的数据仓库/BI方案或行业标准数据模型向用户交付数据，可能会绕过必要的转换过程而直接让业务用户把它们当成能接受的业务术语来使用。

除了要依赖供应商的术语而不是在数据仓库/BI中合并并统一企业的词汇系统之外，另外一个潜在的尖锐问题，就是如何从多个应用领域中对源数据进行整合。供应商解决方案或行业标准数据模型能对内部在用的主数据保持一致性吗？如果不能，这类套装模型就是另一个被隔离的烟囱数据集而已。很显然，这不是我们希望看到的结果。尽管，如果你所有的经营型系统都是同一家ERP厂商提供的，那么你可能会少一些整合障碍；或者你是一家小公司没有专门的IT团队完成这些独立的开发。

你期望从套装模型中获取什么呢？预先内置的通用模型能帮助你识别核心业务流程和相关的通用维度，对于面对初始设计任务而不知所措的数据仓库/BI团队来说，它确实提供了一些好处。对这标准模型，经过几天或者几周的研究之后，大部分团队都会有足够的自信对这些数据进行定制化建模。

然而，获取这些知识，相比套装解决方案或数据模型所标示的高昂价格来说，值吗？你花几周时间与业务用户待在一起，同样能够收获相同的洞察。你不但可以提升对业务需求的理解，还可以在数据仓库/BI项目启动之初就把业务用户绑定进来。

还值得一提的是，只因为套装模型或方案花费数千美元，并不意味着它能展现出通用可接受模型的最佳实践。不幸运的是，有些标准模型体现了通用维度模型的缺陷；如果模型设计人员在对源系统数据捕获的最佳实践上的关注度，远高于在对BI报表和分析上的关注度，你也不要惊讶。即使供应商拥有数据捕获的源代码，设计出一个预告定义好的通用模型依然是非常困难的。

## 关于员工的递归层级

一个常见的员工特征是员工经理的名字，你可能需要简单地把这个属性和其他属性一样加入到员工维度中。但是如果用户需要的不仅仅是经理的名字，设计更复杂的结构就有非常有必要。

有一种方法，就是在事实表上再包含经理的员工键值作为外键，如图9-5所示。这个经理的员工键值，连接到角色扮演的员工维度上。这个角色扮演维上的每一个属性名称都被标记为“经理”，以区分经理概要信息和普通员工概要信息。任何插入到事实表上的一行，这个方法都要把这行关联到员工和他的经理上去。BI分析可以很容易地处理，既可以通过员工属性也可以通过经理属性进行过滤和分组，事实上它们的查询性能是一样的，因为这两个维度提供了对事实表的对称访问。方法的缺点是这个双核的外键必须嵌入到每一个支持管理型报表的事实表上去。

{% asset_image 9-5.png chapter08 %}

另一个选择，是在员工维度行上，把经理的员工键值作为一个属性。这个经理键值要连接到一个员工维度角色扮演维的支架关系上来，角色扮演维度上的所有属性都标识为“经理”，以区别它的经理特征，如图9-6所示。

{% asset_image 9-6.png chapter08 %}

如果员工维度上的经理的外键键值被设计成类型2属性，那么新的员工行就要根据每一个变化产生。然而，我们鼓励你要认真思考关于底层ETL的业务规则。

### 在内嵌经理键上的变化跟踪

我们来看一个例子，假设Abby是Hayden的经理。采用刚刚讲过的支架方法，Hayden的员工维度行将包含一个属性指向Abby所在的经理角色扮演员工维度上的行。如果Hayden的经理变了，并假定企业需要跟踪这些历史变化，那么把经理外键当作类型2并为Hayden创建一个新行，使用新的经理以捕获关于他的新概要信息，这才是恰当的。

然而，考虑一下下面可能出现的结果：如果Abby还是Hayden的经理，但Abby的员工概要发生变化，可能是因为一些不太重要的变化导致的，比如像家庭住址变更。如果家庭住址设计成类型2属性，这个变化会为Abby产生一个新的员工维度行。如果经理键值也设计成了类型2属性，那么Abby新的员工键值的变化也会导致Hayden产生一个新的员工维度行。现在想像一下，如果Abby是一家大型组织的CEO，她的概要中发生了类型2的变化事件，将会涉及到整张维度表的变化；仅仅因为CEO概要中的一个单一的类型2属性变化，而要为每个员工的概要数据都生成一个新概要行，你应当停止这种数据复制。

企业想捕获这些经理概要文件发生的变化吗？如果不想，在员工维度行上的经理键值属性就应当连接到角色扮演员工维度上经理的持久自然键值。当然，这个角色扮演维，应该被限制成只是员工维度上的每一位经理当前生效行的持久自然键值。

### 对管理层级的上下钻取

增加一个属性----既可以是文本标签，也可以是连接到角色扮演维的外键----到一个维度行上，对于处理固定深度的、多对一的员工-经理关系来说，是非常恰当的。然而，如果业务人员想导航到更深的递归层级（像识别员工的完整管理链或者向下钻取以识别被某一经理直接或间接管理的所有员工的活动）上，这就需要更加复杂的方法。

如果你使用一个OLAP工具来查询员工数据，每一个维度行上内嵌的经理键值是满足要求的。主流的OLAP产品包含了父/子层级结构，这种结构对可变的递归层级来说运行平稳。事实上，这是OLAP产品的强项之一。

然而，如果你想在关系型数据库环境中查询递归的员工/经理关系，你必须使用Oracle公司的非标准的CONNECT BY语法，或者SQL的递归通用表表达式（CTE）语法。这两种方法，对于使用BI报表工具的业务用户来说，实事上都是行不通的。

所以，现在你只剩下一个方法，即在第7章中可针对可变深度的客户维度层级处理方法。在图9-7上，图9-6中的员工维度，通过一个桥接表关联到事实表上。这个桥接表的一行代表了一个经理和一个员工的组合，每个员工直接或间接在经理的管理链上，同时还有一条额外的记录行，是经理和他自身的连接。在图9-7中显示的桥接连接，可以让你在一个经理的管理链上向下钻取。

{% asset_image 9-7.png chapter08 %}

就像之前已经讲过的，这个方法有一些不足。建立桥接表是有一点挑战性的，外加桥接表的行太多，所以查询性能也受影响。对即席查询来说，BI用户体验会变得复杂，尽管我们已经看到分析人员会高效使用它。最后，如果用户想向上聚合信息，而不是向下追溯一个管理链，那么连接路径必须颠倒过来。

再说一遍，如果你想连同桥接表一起追踪员工概要信息变化情况，情况会变得更加复杂。如果经理和员工能够反映出类型2的员工概要变化信息，桥接表会快速增长，特别是当高级经理概要发生变化的时会导致新键值的产生，并直接涉及到整个组织。

你可以在桥接表上使用持久的自然键值，而不是捕获类型2概要变化的员工键值。把关系限制到管理层级的当前概要上，这是一件事。然而，如果业务需要保留员工/经理历史的上卷，你需要在桥接表上增加生效日期和结束日期，这样可以捕获每一对员工/经理关系的生效时间区间。

对比图9-7中的桥接表，在使用了持久键值的桥接表上增加新行的速度实质上是大大降低了，因为新行是在报告关系变化时增加的，而不是在任意一个类型2员工属性修改时增加的。根据持久键创建的桥接表易于维护，但对导航来说则有很大挑战，特别是需要把相关的组织结构关联到事实表的事件日期上时。考虑到复杂性，桥接表应该被限制在一个封闭的BI应用程序中，只适合一小部分强大的BI用户使用。

> **疑问：** 为何组织结构要与事件日期相连？

另外一个可选的方法，是第7章中讨论过的处理递归层级的方法（像路径字符串属性），它们也是与管理层次型难题相关的。不幸的是，真的没有高明的解决方案，能够以一种简单和快速的方式，处理这类复杂的结构。

## 多值技能关键字属性

假设IT部想在员工维度上增加熟练使用的技术性技能集信息。你可以考虑把这些技术性技能（像编程语言、操作系统或数据库平台，等），作为描述员工的关键词，每个员工都可以使用这些技能关键字作为标签，你可以根据他们的描述型技能来搜索IT员工。如果你关注的这类技术型技能是有限数量的，那么你就可以把它们包含在员工维度表上作为单个属性。使用位置型维度属性（像Linux属性，这个属性域中有两个值：Linux Skills， No Linux Skills）的优势，是它们易于查询，具有较快的查询性能。在这一点上，这个方法没有问题，但当潜在技能的数量增加时，它就不灵了。

### 技能关键词桥接表

更现实的问题是，每位员工的技能数量，将会是一个可变的、不可预测的数值。在这种情况下，技能关键词属性是多值维度的主要候选方案。技能关键词，在本质上就是一个开放的属性；新技能作为值域，它是常规性增长的。我们将展现两种处理开放式技能集合的建模模型，它们在逻辑上完全等价。

图9-8展示的是处理多值技能的多值维度设计，它作为员工维度表的支架桥接表。你在《第14章：健康产业》中会看到，有时多值桥接表可以直接和事实表相连。

{% asset_image 9-8.png chapter08 %}

技能组桥接表会把一些给定的技能关键字组成一个集合。IT员工中精通Oracle、Unix和SQL的人将会被分配同一个技能组键值。在技能组桥接表中，将会有三行数据来代表这个组的技能组成，每一行代表与技能相关的一个关键词（Oracle、Unix和SQL）。

> **老韩注：** 
> 
> 请看下图，这是支架桥接表的组成：
> 
> {% asset_image 001.png chapter08 %}

#### *AND/OR的查询困境*

假设你按图9-8建立了模型，你依然留下了一个严重的查询问题。对技能关键词的查询请求分为两类。OR查询（比如，具备Unix或Linux经验之一即可）可以在技能维度表的技能描述属性（Employee Skill D）上满足简单的OR约束要求。然而，AND查询（比如，同时具备Unix和Linux经验）则非常困难，因为AND约束是要跨越技能维度的两行进行约束。众所周知，SQL处理跨行约束是很吃力的。答案是创建SQL代码使用并（UNION）或交(INTERSECT)等集合操作符，可能还要一个定制化的界面用来对业务用户隐藏这个复杂的逻辑。SQL代码看起来如下：

```
(SELECT employee_ID, employee_name
FROM Employee, SkillBridge, Skills
WHERE Employee.SkillGroupKey = SkillBridge.SkillGroupKey AND
 SkillGroup.SkillKey = Skill.SkillKey AND
 Skill.Skill = "UNIX")
UNION / INTERSECTION
 (SELECT employee_ID, employee_name
 FROM Employee, SkillBridge, Skills
 WHERE Employee.SkillGroupKey = SkillBridge.SkillGroupKey AND 
 SkillGroup.SkillKey = Skill.SkillKey AND 
 Skill.Skill = "LINUX")
```

> **老韩注：** 交集的操作符不是intersection，在Oracle和PostgreSQL中都是intersect。至于Sql Server中是不是intersection，请读者自己求证。intersection是名词，操作符是动词，所以凭感觉intersection不对。

### 技能关键词文本字符串

你可以通过简化设计，以移除多对多的桥接关系和union/intersect等SQL集合操作符。有一种方法，就是对员工维度表增加一个技能列表支架，这个支架上包含一个长的文本字符串，这个字符串拼接了所有的列表键值的技能关键词信息。需要一个特殊的定界符（像反斜杠或竖条），放在每个技能文本字符串的开始位置，和在每个技能列表的最后位置。这样包含了Unix和C++的技能字符串，看起来会是这样：|Unix|C++|。这个支架方法假定有好多员工共享一个通用的技能列表。如果这个列表不经常重用，你要放弃这个技能列表支架，而是把简单包含了技能列表的字符串用作员工维度表的属性，如图9-9。

{% asset_image 9-9.png chapter08 %}

文本字符串搜索可能是一个挑战，因为查询字符串时的大小写问题会导致文本意思含糊不清，是UNIX？是Unix？还是unix？通过强制使用大多数SQL环境中都有的Ucase函数，对技能列表字符串进行大写转换，可以解决这个问题。

针对图9-9的设计，AND/OR的困境问题可以在单条SELECT语句里被解决。OR约束看起来是这样的：

```
UCase(skill_list) like '%|UNIX|% OR UCase(skill_list) like '%|LINUX|%'
```
同时，AND约束正好有相同的结构：

```
UCase(skill_list) like '%|UNIX|' AND UCase(skill_list) like '%|LINUX|%'
```

%标识符是SQL中定义的一个通配符模式匹配字符串，它匹配0个或更长的字符串。竖条定界符在约束中被显式使用，以精确匹配想要检索的关键词，并且不会返回错误的匹配。

图9-9中显示的关键词列表方法，可以在任何关系型数据库中使用，因为它是建立在标准SQL基础之上的。尽管文本字符串方法适用于AND和OR查询，但它不支持对技能关键词的计数查询。

> **老韩注：** 上述函数在技术都是可行的，但考虑到效率，最好不要在数据查询时使用，可在ETL中使用。对于％之类的通配符，最好不要使用，代替方案是使用正则表达式，效率更高。

## 调查问卷数据

HR部门经常会从员工那里收集调查问卷数据，特别是收集同行和/或管理评审数据。部门分析问卷反馈，以决定某个被评审的员工在一个部门中的平均比率。

为了在维度模型中处理问卷数据，一般来说要创建一个事实表，事实表上的每一行是针对一个调查对象调查的一个问题，如图9－10所示。模型中的两个角色扮演的员工维度，一个是参与调查的员工，一个是被评审的员工。调查维度具有调查工具的描述符。问题维度提供了问题和它的分类；大致情况是，相同的问题会在多个调查中被问及。当在广阔的问卷数据库中检索具体话题时，调查和问题维度就显得非常有用。响应维度包括响应和可能的响应分类，比如赞许的和敌对的。

{% asset_image 9-10.png chapter08 %}

创建一个如图9－10所示的简单模型，它可以对调查数据进行健壮地切片和切块。针对这种设计模型的各种变化，对分析调查数据的所有类型，包括客户满意度和产品使用反馈，都是有用的。

### 文本评论

事实一般被认为是连续的、可以量化的数值型度量；另一方面，维度属性则是从一个离散的域值列表中抽离出来的。所以，你如何处理文本型的评论信息呢？像经理对绩效评估的解释，或者调查对象针对调查问题的不拘形式的反馈，它们似乎不符合事实或维度类别的明确分类。尽管IT专家可能会凭借直觉，简单地把它们从维度设计中排除，但业务用户可能希望把它们保留下来以供深入描述绩效度量使用。

当已经确认企业不愿放弃文本评论数据后，你就要决定是否文本型评论可以被解析成行为良好的维度属性。尽管有时候会有机会对文本进行分类（比如点赞还是投诉），但所有的文本评论还是要保留的。

因为自由形式的文本表达了非常多潜在的值，设计人员有时试图在事实表上存储文本评论。尽管知道到事实表一般只限定在外键、退化维度和数值型度量这个范围内，他们还是主张文本评论只是另一个退化维度而已。不幸的是，文本评论不满足退化维度的要求。

不能把评论当作文本度量来处理，我们推荐在事实表之外保留它们。评论既可以被捕获在一个独立的评论维度里（事实表上有一个相关的外键），也可以是事务粒度维度表的一个属性。在有些情况下，多次观察到完全一样的评论，这个评论最低限度会以“没有评论”的评论形式出现。如果评论的数量基数小于事务的数量，文本就应当捕获在评论维度里。否则，如果每一个事件都有一个唯一的评论，那它就应当作为事务维度属性。任何一种情况下，不管评论是否被作为评论维度还是事务维度来处理，将相当大的维度与事实表连接，其查询性能都将会变慢。然而，当用户在浏览评论时，他们很可能会显著地过滤他们的查询结果，因为他们实际上只阅读受限制的一小部分评论而已。同时，关于事实表上的绩效度量的更为通用的分析，不会因在每个事实表查询上额外增加的文本评论而增加负担。

## 总结

在本章，我们讨论了HR数据环境中的几个概念。首先，我们深入阐述了对员工维度表进行增补的好处。在HR的世界里，这张维度表解决了在任何时间点诸多与员工状态和概要相关的问题。我们草拟了代表HR应用中与多个流程相关的总结矩阵，强调了核心的人数统计快照事实表，以及供应商提供的套装设计方案和数据模型的优劣势，讨论了管理层级的上卷和多值维度属性如何处理。最后，我们提供了关于调查问卷及文本型评论相关数据处理的简要综述。


## 习惯用语

序号 |英语	             |中文
--   |--                |--
1	 |	pros and cons	     |	优缺点
2	 |	survey questionaire   |	调查问卷
3   |  silver bullet       |高招，良方